---
page_title: "mist_site_evpn_topology Resource - terraform-provider-mist"
subcategory: "Wired Assurance"
description: |-
  This resource manages the Site Evpn Topologys.
  EVPN allows an alternative but more efficient LAN architecture utilizing VxLAN / MP-BGP to separate the control plane (MAC / IP Learning) from the forwarding plane.
  -> To create or manage your EVPN Topology with the Mist Provider, please refer to the How To - EVPN Topology Guide.
---

# mist_site_evpn_topology (Resource)

This resource manages the Site Evpn Topologys.

EVPN allows an alternative but more efficient LAN architecture utilizing VxLAN / MP-BGP to separate the control plane (MAC / IP Learning) from the forwarding plane.

-> To create or manage your EVPN Topology with the Mist Provider, please refer to the `How To - EVPN Topology` Guide.


## Example Usage

```terraform
resource "mist_site_site_evpn_topology" "evpn_one" {
  site_id = mist_site.terraform_test.id
  name    = "evpn_one"
  evpn_options = {
    routed_at = "core"
    overlay = {
      as = 65000
    },
    core_as_border        = true
    auto_loopback_subnet  = "172.16.192.0/24"
    auto_loopback_subnet6 = "fd33:ab00:2::/64"
    per_vlan_vga_v4_mac   = false
    underlay = {
      as_base  = 65001
      use_ipv6 = false
      subnet   = "10.255.240.0/20"
    }
    auto_router_id_subnet = "172.16.254.0/23"
  }
  switches = [
    {
      mac  = "020004000001"
      role = "core"
    },
    {
      mac  = "02000400002"
      role = "core"
    },
    {
      mac  = "02000400003"
      role = "distribution"
    },
    {
      mac  = "02000400004"
      role = "distribution"
    },
    {
      mac  = "02000400005"
      role = "access"
    },
    {
      mac  = "02000400006"
      role = "access"
    }
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String)
- `site_id` (String)
- `switches` (Attributes Map) Property key can be the switch MAC Address (see [below for nested schema](#nestedatt--switches))

### Optional

- `evpn_options` (Attributes) EVPN Options (see [below for nested schema](#nestedatt--evpn_options))
- `pod_names` (Map of String) Property key is the pod number

### Read-Only

- `id` (String) Unique ID of the object instance in the Mist Organnization
- `org_id` (String)

<a id="nestedatt--switches"></a>
### Nested Schema for `switches`

Required:

- `role` (String) use `role`==`none` to remove a switch from the topology. enum: `access`, `collapsed-core`, `core`, `distribution`, `esilag-access`, `none`

Optional:

- `pod` (Number) optionally, for distribution / access / esilag-access, they can be placed into different pods. e.g. 
  * for CLOS, to group dist / access switches into pods
  * for ERB/CRB, to group dist / esilag-access into pods
- `pods` (List of Number) by default, core switches are assumed to be connecting all pods. 
if you want to limit the pods, you can specify pods.

Read-Only:

- `deviceprofile_id` (String)
- `evpn_id` (Number)
- `mac` (String)
- `model` (String)
- `router_id` (String)
- `site_id` (String)


<a id="nestedatt--evpn_options"></a>
### Nested Schema for `evpn_options`

Optional:

- `auto_loopback_subnet` (String) optional, for dhcp_relay, unique loopback IPs are required for ERB or IPClos where we can set option-82 server_id-overrides
- `auto_loopback_subnet6` (String) optional, for dhcp_relay, unique loopback IPs are required for ERB or IPClos where we can set option-82 server_id-overrides
- `auto_router_id_subnet` (String) optional, this generates router_id automatically, if specified, `router_id_prefix` is ignored
- `auto_router_id_subnet6` (String) optional, this generates router_id automatically, if specified, `router_id_prefix` is ignored
- `core_as_border` (Boolean) optional, for ERB or CLOS, you can either use esilag to upstream routers or to also be the virtual-gateway
when `routed_at` != `core`, whether to do virtual-gateway at core as well
- `overlay` (Attributes) (see [below for nested schema](#nestedatt--evpn_options--overlay))
- `per_vlan_vga_v4_mac` (Boolean) by default, JUNOS uses 00-00-5e-00-01-01 as the virtual-gateway-address's v4_mac
if enabled, 00-00-5e-00-XX-YY will be used (where XX=vlan_id/256, YY=vlan_id%256)
- `routed_at` (String) optional, where virtual-gateway should reside. enum: `core`, `distribution`, `edge`
- `underlay` (Attributes) (see [below for nested schema](#nestedatt--evpn_options--underlay))
- `vs_instances` (Attributes Map) optional, for EX9200 only to seggregate virtual-switches (see [below for nested schema](#nestedatt--evpn_options--vs_instances))

<a id="nestedatt--evpn_options--overlay"></a>
### Nested Schema for `evpn_options.overlay`

Optional:

- `as` (Number) Overlay BGP Local AS Number


<a id="nestedatt--evpn_options--underlay"></a>
### Nested Schema for `evpn_options.underlay`

Optional:

- `as_base` (Number) Underlay BGP Base AS Number
- `routed_id_prefix` (String)
- `subnet` (String) underlay subnet, by default, `10.255.240.0/20`, or `fd31:5700::/64` for ipv6
- `use_ipv6` (Boolean) if v6 is desired for underlay


<a id="nestedatt--evpn_options--vs_instances"></a>
### Nested Schema for `evpn_options.vs_instances`

Optional:

- `networks` (List of String)



## Import
Using `terraform import`, import `mist_site_evpn_topology` with:
```shell
# EVPN Topology can be imported by specifying the site_id and the evpn_topology_id
terraform import mist_site_evpn_topology.evpn_one 17b46405-3a6d-4715-8bb4-6bb6d06f316a.d3c42998-9012-4859-9743-6b9bee475309
```